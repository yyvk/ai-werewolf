# 🎮 Web界面查看AI对决指南

## 🎉 功能已实现！

现在你可以通过Web界面看到AI的真实对决了！

---

## ✅ 已实现的功能

### 后端改进
1. ✅ **真实游戏引擎集成** - API现在会运行真正的游戏逻辑
2. ✅ **AI智能体创建** - 自动创建6个AI玩家
3. ✅ **角色分配** - 自动分配狼人、村民、预言家、女巫
4. ✅ **AI发言系统** - AI会真实地推理和发言
5. ✅ **投票系统** - AI会投票淘汰玩家
6. ✅ **游戏事件记录** - 所有发言和投票都被记录
7. ✅ **下一轮功能** - 可以继续进行游戏

### 前端改进
1. ✅ **玩家展示** - 显示玩家角色和存活状态
2. ✅ **事件流展示** - 显示AI发言和投票
3. ✅ **下一轮按钮** - 继续游戏的按钮
4. ✅ **死亡玩家样式** - 已淘汰玩家显示为灰色+骷髅

---

## 🚀 使用方法

### 步骤1：启动服务

**后端**（终端1）：
```bash
python main.py --mode web
```

**前端**（终端2）：
```bash
cd frontend
npm run dev
```

### 步骤2：创建游戏

1. 打开浏览器：http://localhost:3000
2. 点击"创建新游戏"
3. 配置参数（默认即可）
4. 点击"创建游戏"

### 步骤3：开始游戏并观看AI对决

1. 进入游戏房间
2. 点击"🎮 开始游戏"按钮
3. **等待30-60秒**（AI正在思考和讨论）
4. 点击"🔄 刷新状态"按钮查看结果

### 步骤4：查看AI对决信息

刷新后你会看到：

**玩家列表**：
- 🤖 **存活玩家** - 彩色背景
- 💀 **已淘汰玩家** - 灰色背景
- 显示每个玩家的角色（狼人、村民、预言家、女巫）

**游戏事件**：
- ✅ AI的发言内容
- ✅ AI的投票选择
- ✅ 谁被淘汰了

### 步骤5：继续游戏

1. 点击"▶️ 下一轮"按钮
2. 等待30-60秒
3. 刷新查看新一轮的对决

---

## 📊 API测试（直接调用）

如果前端有问题，可以直接通过API测试：

### 创建游戏
```powershell
$body = @{num_players=6; llm_provider="openai"} | ConvertTo-Json
$result = Invoke-RestMethod -Uri http://localhost:8000/api/games -Method POST -Body $body -ContentType "application/json"
$gameId = $result.game_id
Write-Host "游戏ID: $gameId"
```

### 开始游戏
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/games/$gameId/start" -Method POST
Start-Sleep -Seconds 30  # 等待AI思考
```

### 查看游戏状态
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/games/$gameId" | ConvertTo-Json -Depth 5
```

你会看到完整的数据：
- `round`: 当前轮次
- `phase`: 当前阶段
- `players`: 所有玩家（包含角色、存活状态）
- `events`: 所有游戏事件（AI发言、投票等）

### 进行下一轮
```powershell
Invoke-RestMethod -Uri "http://localhost:8000/api/games/$gameId/next-round" -Method POST
Start-Sleep -Seconds 30  # 等待AI思考
```

---

## 🎭 AI对决示例

当你查看游戏状态时，会看到类似这样的数据：

```json
{
  "round": 1,
  "phase": "voting",
  "players": [
    {"id": 1, "name": "玩家1", "role": "狼人", "is_alive": true},
    {"id": 2, "name": "玩家2", "role": "狼人", "is_alive": false},  // 被淘汰
    {"id": 3, "name": "玩家3", "role": "村民", "is_alive": true},
    {"id": 4, "name": "玩家4", "role": "村民", "is_alive": true},
    {"id": 5, "name": "玩家5", "role": "预言家", "is_alive": true},
    {"id": 6, "name": "玩家6", "role": "女巫", "is_alive": true}
  ],
  "events": [
    "游戏开始！",
    "[玩家1] 大家好，我是玩家1，我觉得...",
    "[玩家2] 我认为需要仔细观察每个人的行为...",
    "[玩家3] 根据前面的发言，我怀疑...",
    "[玩家4] 我同意玩家3的观点...",
    "[玩家5] 我是预言家，昨晚验到...",
    "[玩家6] 作为女巫，我需要谨慎...",
    "[玩家1] 投票给 玩家2",
    "[玩家3] 投票给 玩家2",
    "[玩家4] 投票给 玩家2",
    "玩家2(玩家2-狼人) 被投票淘汰"
  ]
}
```

---

## 💡 使用技巧

### 1. 耐心等待
AI需要时间思考（每个玩家2-5秒），一轮完整的讨论和投票需要30-60秒。

### 2. 多刷新
游戏是异步运行的，需要手动刷新查看最新状态。

### 3. 观察事件流
所有AI的发言和投票都在"游戏事件"区域显示，滚动查看完整对决过程。

### 4. 注意玩家状态
- 存活玩家：彩色卡片，🤖
- 已淘汰：灰色卡片，💀

---

## 🔧 故障排除

### 前端显示不更新？
1. 点击"🔄 刷新状态"按钮
2. 按F5刷新浏览器
3. 清除浏览器缓存后重试

### API返回空数据？
- 确保等待足够时间（30秒+）让AI完成思考
- 检查后端终端是否有错误输出

### 游戏一直在"进行中"？
- 现在不会了！新版本会真实运行游戏逻辑
- 如果还有问题，重启后端服务

---

## 📸 预期效果

### 游戏房间界面

```
┌─────────────────────────────────────────────────────┐
│  游戏信息                                            │
│  游戏ID: xxx                                        │
│  状态: 进行中                                       │
│  阶段: discussion / voting                          │
│  轮次: 第1轮                                       │
│  玩家数: 6                                         │
│                                                     │
│  [▶️ 下一轮]  [🔄 刷新状态]                       │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│  玩家列表                                            │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐        │
│  │🤖 │ │💀 │ │🤖 │ │🤖 │ │🤖 │ │🤖 │        │
│  │玩家1│ │玩家2│ │玩家3│ │玩家4│ │玩家5│ │玩家6│   │
│  │狼人 │ │狼人 │ │村民 │ │村民 │ │预言家│ │女巫 │   │
│  │存活 │ │淘汰 │ │存活 │ │存活 │ │存活 │ │存活 │   │
│  └────┘ └────┘ └────┘ └────┘ └────┘ └────┘        │
└─────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────┐
│  游戏事件                                            │
│  • 游戏开始！                                       │
│  • [玩家1] 大家好，我认为我们需要...              │
│  • [玩家2] 我觉得需要仔细观察...                   │
│  • [玩家3] 根据前面的发言...                      │
│  • [玩家1] 投票给 玩家2                           │
│  • [玩家3] 投票给 玩家2                           │
│  • 玩家2(玩家2-狼人) 被投票淘汰                   │
└─────────────────────────────────────────────────────┘
```

---

## 🎊 总结

### 你现在可以：
1. ✅ 在Web界面创建游戏
2. ✅ 点击按钮开始游戏
3. ✅ **看到AI的真实对决**
4. ✅ 观看AI的发言和推理
5. ✅ 查看投票和淘汰过程
6. ✅ 继续进行多轮游戏
7. ✅ 看到最终的胜负结果

### 与之前的区别：
- ❌ 之前：只是改变状态，没有实际游戏
- ✅ 现在：真正的游戏引擎，AI真实对决！

---

**🎮 现在就去试试吧！在Web界面看AI之间的精彩对决！**

---

**更新时间**: 2025-11-04  
**版本**: 2.0 - 真实游戏引擎集成  





