# 🎙️ AI 狼人杀 - 语音功能使用说明

## 🌟 功能介绍

你的 AI 狼人杀游戏现在支持**实时语音播放**功能！当玩家发言时，系统会自动将文字转换为语音并播放，让游戏体验更加真实和有趣。

---

## 🚀 快速使用（3 步开始）

### 第一步：配置 API 密钥

1. 打开项目根目录的 `.env` 文件

2. **如果你已经配置了 ModelScope**，恭喜，无需额外配置！TTS 会自动使用你现有的 `OPENAI_API_KEY`

3. **如果还没配置**，添加以下内容：
```ini
OPENAI_API_KEY=你的Token
OPENAI_API_BASE=https://api-inference.modelscope.cn/v1/
TTS_ENABLED=true
```

4. 获取 Token：访问 https://modelscope.cn/my/myaccesstoken

### 第二步：安装依赖

```bash
pip install httpx
```

### 第三步：启动游戏

**启动后端**：
```bash
python main.py --mode web
```

**启动前端**（新终端）：
```bash
cd frontend
npm run dev
```

访问 http://localhost:5173 开始游戏！

---

## 🎮 游戏中的语音体验

### 自动播放
- 玩家发言时，文字会逐字显示（打字机效果）
- 文字显示完成后，自动播放该玩家的语音
- 每个玩家的语音依次播放，不会重叠

### 视觉反馈
- 正在发言的玩家卡片会发光
- 头像会有跳动动画
- 日志中会显示完整的发言记录

---

## 🎨 自定义音色（可选）

在 `.env` 文件中可以选择不同的音色：

```ini
# 智能女声（默认，推荐）
TTS_VOICE=zhitian_emo

# 温柔女声
TTS_VOICE=aiya

# 活泼女声
TTS_VOICE=xiaoyun

# 低沉男声
TTS_VOICE=xiaogang
```

---

## ⚙️ 更多配置选项

### 调整语速
```ini
TTS_SPEED=0.8   # 慢速
TTS_SPEED=1.0   # 正常（推荐）
TTS_SPEED=1.2   # 快速
```

### 调整音调
```ini
TTS_PITCH=0.9   # 低沉
TTS_PITCH=1.0   # 正常（推荐）
TTS_PITCH=1.1   # 清脆
```

### 关闭语音
如果不想使用语音功能，可以关闭：
```ini
TTS_ENABLED=false
```

---

## 🔧 测试语音功能

在启动游戏前，可以先测试语音是否正常：

```bash
python test_tts.py
```

如果看到 ✅ 标记，说明配置成功！

---

## ❓ 常见问题

### Q1: 没有声音怎么办？
**A**: 
1. 检查浏览器是否允许自动播放（可能需要点击页面允许播放）
2. 检查 `.env` 中的 `MODELSCOPE_ACCESS_TOKEN` 是否正确
3. 查看浏览器控制台（F12）是否有错误信息

### Q2: 语音生成很慢？
**A**: 
1. 确保使用的是 16k 模型（默认配置）
2. 检查网络连接
3. ModelScope 服务在国内，速度通常很快

### Q3: 可以换成其他音色吗？
**A**: 
可以！在 `.env` 中修改 `TTS_VOICE` 参数，可选的音色包括：
- `zhitian_emo` - 智天（带情感）⭐
- `aiya` - 艾雅（温柔）
- `xiaogang` - 小刚（男声）
- `jiajia` - 佳佳（女声）

### Q4: 需要额外付费吗？
**A**: 
ModelScope 提供免费的 API 额度，对于个人使用完全足够。

---

## 📚 详细文档

- **快速开始**: [TTS_QUICKSTART.md](./TTS_QUICKSTART.md)
- **完整配置指南**: [TTS_GUIDE.md](./TTS_GUIDE.md)
- **实现总结**: [TTS_IMPLEMENTATION_SUMMARY.md](./TTS_IMPLEMENTATION_SUMMARY.md)

---

## 🎉 开始享受你的语音版 AI 狼人杀吧！

现在你可以：
1. ✅ 创建游戏
2. ✅ 开始游戏
3. ✅ 听 AI 玩家发言
4. ✅ 感受真实的狼人杀体验！

有任何问题，请查看文档或提出反馈。祝你游戏愉快！ 🎮🔊

